<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Cadastro de Quarto</title>
    <link rel="stylesheet" href="css/style.css" />
        <link rel="icon" type="image/x-icon" href="imagens/logo_branco .svg" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="imagens/logo_branco .svg"
    />
    <link rel="logo" href="imagens/logo_branco .svg" />
  </head>
  <body>
    <div class="container-quarto">
      <br />
      <br />
      <button class="btn-voltar" onclick="window.location.href='index.html';">
        Voltar
      </button>
      <form id="cadastroQuartoForm" class="form-quarto">
        <div class="campos-linha">
          <div class="campo campo-tipo">
            <label for="tipo_id">Tipo do quarto</label>
            <div class="tipo-select-btn">
              <select id="tipo_id" name="tipo_id" required></select>
              <div style="display:flex; gap:8px">
                <button type="button" id="novoTipoBtn">Novo tipo</button>
                <button type="button" id="excluirTipoBtn" style="background:#c0392b;color:#fff">Excluir tipo</button>
              </div>
            </div>
          </div>
          <div class="campo">
            <label for="numero">Número do quarto</label>
            <input type="text" id="numero" name="numero" required />
          </div>
        </div>
        <div class="campos-linha">
          <div class="campo">
            <label for="descricao">Descrição do quarto</label>
            <textarea
              id="descricao"
              name="descricao"
              rows="5"
              required
            ></textarea>
          </div>
          <div class="campo">
            <label for="valor">Valor da diária</label>
            <input type="text" id="valor" name="valor" required />
          </div>
        </div>
        <button class="btn-registrar" type="submit">Registrar</button>
      </form>
    </div>
    <!-- Substitua o modal antigo por este -->
    <div id="modalNovoTipo">
      <div class="modal-content">
        <h3>Novo Tipo de Quarto</h3>
        <label for="novoTipoTipo">Tipo:</label>
        <input type="text" id="novoTipoTipo" required />
        <label for="novoTipoValor">Valor da diária:</label>
        <input type="number" id="novoTipoValor" required />
        <label for="novoTipoDescricao">Descrição:</label>
        <input type="text" id="novoTipoDescricao" required />
        <div style="display: flex; gap: 10px; margin-top: 10px">
          <button id="salvarNovoTipo" type="button">Salvar</button>
          <button id="cancelarNovoTipo" type="button">Cancelar</button>
        </div>
      </div>
    </div>
    <script src="js/script.js"></script>
    <script>
      // Botão para excluir o tipo selecionado
      document.addEventListener('DOMContentLoaded', function(){
        const btn = document.getElementById('excluirTipoBtn');
        const select = document.getElementById('tipo_id');
        if(!btn || !select) return;
        btn.addEventListener('click', async function(){
          if(!select.value){
            alert('Selecione um tipo para excluir.');
            return;
          }
          const confirmado = confirm('Excluir o tipo selecionado? Esta ação não pode ser desfeita.');
          if(!confirmado) return;
          try{
            const resp = await fetch(`http://localhost:3000/api/tipos-quarto/${select.value}`, { method: 'DELETE' });
            const data = await resp.json().catch(()=>({}));
            if(resp.ok){
              alert('Tipo de quarto excluído com sucesso.');
              // Recarrega a lista de tipos e limpa seleção
              if (typeof carregarTiposQuarto === 'function') {
                await carregarTiposQuarto();
              } else {
                // fallback simples
                window.location.reload();
              }
            } else {
              alert((data && data.message) || 'Não foi possível excluir este tipo.');
            }
          }catch(e){
            alert('Erro ao conectar ao servidor.');
          }
        });
      });
    </script>
  </body>
</html>
